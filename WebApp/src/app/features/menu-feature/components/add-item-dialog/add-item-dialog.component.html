<h2 mat-dialog-title>Add Item</h2>
<mat-dialog-content responsive-dialog-content>
  <form #formAutoFocus="appModalFormAutoFocus" (keydown.enter)="$event.preventDefault()" [formGroup]="form"
        appModalFormAutoFocus class="flex flex-col gap-4">
    <app-form-section title="Overview">
      <div class="flex flex-col gap-4">
        <div class="flex flex-col gap-4">
          <!-- Text Input -->
          <mat-form-field class="w-full max-w-lg">
            <mat-label>Name</mat-label>
            <input formControlName="name" inputmode="text" matInput type="text">
            @if (form.controls.name.hasError('required')) {
              <mat-error>
                Name is required
              </mat-error>
            }
          </mat-form-field>
          <!-- Category Select -->
          <div>
            <mat-form-field class="w-full max-w-80">
              <mat-label>Category</mat-label>
              <mat-select formControlName="categoryId">
                @for (category of selectOptions(); track category) {
                  <mat-option [value]="category.id">
                    {{ category.name }}
                  </mat-option>
                } @empty {
                  <mat-option disabled>No Categories</mat-option>
                }
              </mat-select>
              @if (form.controls.categoryId.hasError('required')) {
                <mat-error>
                  Category is required
                </mat-error>
              }
            </mat-form-field>
            <button (click)="openDialog()" class="relative  ml-2" mat-button type="button">Add
              <mat-icon>add</mat-icon>
            </button>
          </div>
          <!-- Price Input -->
          <mat-form-field class="max-w-40">
            <mat-label>Price</mat-label>
            <input formControlName="price" inputmode="number" matInput type="number">
            @if (form.controls.price.hasError('required')) {
              <mat-error>
                Price is required
              </mat-error>
            }
          </mat-form-field>
        </div>

      </div>
    </app-form-section>
    <app-form-section title="General">
      <div class="flex flex-col gap-4">



        <!-- Text Area -->
        <app-single-image-upload (uploadChange)="uploadChange($event)" [width]="'250px'" [height]="'250px'"></app-single-image-upload>
        <mat-form-field class="w-full mt-4">
          <mat-label>Description</mat-label>
          <textarea [cdkTextareaAutosize] formControlName="description" matInput rows="2"></textarea>
        </mat-form-field>
        <!-- Number Input -->
        <mat-form-field class="w-full max-w-52">
          <mat-label>Weight</mat-label>
          <input formControlName="weight" inputmode="numeric" matInput type="number">
        </mat-form-field>

      </div>
    </app-form-section>
    <app-form-section title="Nutritional">
      <div class="flex flex-col gap-4">
        <!-- Text Area -->
        <mat-form-field class="w-full">
          <mat-label>Ingredients</mat-label>
          <textarea [cdkTextareaAutosize] formControlName="ingredients" matInput rows="2"></textarea>
        </mat-form-field>
        <!-- Text Area -->
        <mat-form-field class="w-full">
          <mat-label>Allergens</mat-label>
          <textarea [cdkTextareaAutosize] formControlName="allergens" matInput rows="2"></textarea>
        </mat-form-field>
        <!-- Text Area -->
        <mat-form-field class="w-full">
          <mat-label>Nutritional Values</mat-label>
          <textarea [cdkTextareaAutosize] formControlName="nutritionalValues" matInput rows="2"></textarea>
        </mat-form-field>
      </div>

    </app-form-section>



  </form>
</mat-dialog-content>
<mat-dialog-actions>
  <button (click)="closeDialog()" class="mr-2" mat-button type="button">Cancel</button>
  <button (click)="submit(); formAutoFocus.focus()" [class.shake]="shake()"
          [class.spinner]="loading()"
          [disabled]="loading()" mat-flat-button type="button">Save
  </button>
</mat-dialog-actions>
